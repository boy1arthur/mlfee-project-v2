<!DOCTYPE html>
<html lang="ko" class="scroll-smooth">
<head>
    <!-- 1. SEO 및 기본 페이지 설정 -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>혼테일 브레이커 | MLFEE</title>
    <meta name="description" content="메이플랜드 혼테일 레이드 공략을 위한 메랜 필수 유틸리티. 공무, 유혹, 리저렉션 타이머와 파티 명단 관리를 한 곳에서 해결하세요.">
    <meta property="og:title" content="혼테일 브레이커 | MLFEE">
    <meta property="og:description" content="혼테일 레이드 공략을 위한 메이플랜드 필수 유틸리티">
    <meta property="og:image" content="../../images/mlfee-og-breaker.png">
    <link rel="icon" href="../../images/mlfee-logo.png" type="image/png">

    <!-- 2. 외부 라이브러리 및 폰트 -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8602495420447615" crossorigin="anonymous"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <!-- 3. 원본 도구의 전용 스타일 -->
    <style>
        :root { --base-bg: #121212; --card-bg: #1e1e1e; --input-bg: #2a2a2a; --border-color: #444; --text-color: #e0e0e0; --gold-color: #ffd700; }
        body { font-family: 'Noto Sans KR', sans-serif; background-color: var(--base-bg); color: var(--text-color); }
        html[lang="ja"] body { font-family: 'Noto Sans JP', sans-serif; }
        html[lang="en"] body { font-family: 'Inter', sans-serif; }
        .main-title { font-size: 2.5rem; font-weight: 700; background: linear-gradient(90deg, #d4af37, #ffd700, #e6bf4a, #ffd700, #d4af37); background-size: 200% auto; color: #000; background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: shine 8s linear infinite; }
        @keyframes shine { to { background-position: 200% center; } }
        .card { background-color: var(--card-bg); border-radius: 0.5rem; border: 1px solid var(--border-color); }
        .input-field { background-color: var(--input-bg); border: 1px solid #555; color: var(--text-color); border-radius: 0.375rem; padding: 0.5rem 0.75rem; width: 100%; transition: all 0.2s; }
        .input-field:focus { outline: none; border-color: var(--gold-color); background-color: #333; }
        .btn { background-color: #333; color: var(--gold-color); font-weight: 600; padding: 0.75rem 1rem; border-radius: 0.375rem; cursor: pointer; border: 1px solid var(--gold-color); transition: all 0.2s; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; text-align: center; }
        .btn:hover:not(:disabled) { background-color: var(--gold-color); color: var(--base-bg); }
        .btn:disabled { background-color: #2a2a2a; color: #666; border-color: #444; cursor: not-allowed; }
        .btn.active { background-color: #e53e3e; color: white; border-color: #e53e3e; }
        .section-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 1.5rem; padding-bottom: 0.5rem; text-align: center; color: var(--gold-color); border-bottom: 1px solid var(--gold-color); }
        .draggable-item { display: flex; align-items: center; justify-content: space-between; background-color: #2a2a2a; padding: 0.75rem; margin-bottom: 0.5rem; border-radius: 0.375rem; border-left: 4px solid var(--gold-color); cursor: grab; user-select: none; }
        .sortable-ghost { opacity: 0.4; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out; }
        .accordion-icon { transition: transform 0.3s ease-out; }
        .accordion-header.active .accordion-icon { transform: rotate(180deg); }
        .time-display { font-size: 1.25rem; font-weight: 700; }
        .death-timer-display { font-size: 0.9rem; font-weight: bold; color: #ff8e8e; margin-left: 0.5rem; width: 50px; text-align: right; }
        .seduction-log { background-color: #2a2a2a; border-radius: 0.375rem; padding: 0.75rem; height: 120px; overflow-y: auto; font-family: monospace; font-size: 0.9rem; }
    </style>
</head>
<body class="dark" data-tool-id="breaker">

<header class="sticky top-0 z-50 bg-gray-900/70 backdrop-blur-lg border-b border-white/10">
    <div class="container mx-auto px-4 flex justify-between items-center h-16">
        <a href="../../index.html" class="font-serif text-2xl font-bold tracking-wider text-white">MLFEE</a>
        <!-- ✨ [오류 수정] 링크가 메인 페이지의 도구 섹션으로 이동하도록 경로를 수정했습니다. -->
        <a href="../../index.html#tools" class="text-gray-300 hover:text-white">도구 목록으로</a>
    </div>
</header>

<main class="py-8 px-4">
    <div class="w-full max-w-screen-2xl mx-auto space-y-8">
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- 메인 도구 영역 -->
            <div class="lg:col-span-2 space-y-8">
                
                <div class="flex justify-between items-center">
                    <div></div>
                    <div class="text-center">
                        <h1 class="main-title" data-lang-key="mainTitle">혼테일 브레이커</h1>
                        <p class="text-lg text-gray-400 mt-2" data-lang-key="creator">by 소년아서</p>
                    </div>
                    <div id="language-selector" class="flex gap-2">
                        <button data-lang="ko" class="lang-btn btn p-2 text-sm">KR</button>
                        <button data-lang="en" class="lang-btn btn p-2 text-sm">EN</button>
                        <button data-lang="ja" class="lang-btn btn p-2 text-sm">JP</button>
                    </div>
                </div>

                <!-- [오류 수정] 광고 컨테이너에서 flex 관련 클래스를 제거하여 너비 계산 오류를 해결합니다. -->
                <div class="card text-center p-4 min-h-[100px]">
                    <ins class="adsbygoogle"
                         style="display:block"
                         data-ad-client="ca-pub-8602495420447615"
                         data-ad-slot="7934532932"
                         data-ad-format="auto"
                         data-full-width-responsive="true"></ins>
                    <script>
                         (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <div class="card p-4">
                    <div class="flex flex-col md:flex-row justify-around items-center text-center gap-4">
                        <div>
                            <h3 class="font-bold text-xl text-gray-400 mb-2" data-lang-key="currentTime">현재 시간</h3>
                            <p id="browser-clock" class="text-3xl font-mono"></p>
                        </div>
                        <div>
                            <h3 class="font-bold text-xl text-gray-400 mb-2" data-lang-key="horntailLimit">혼테일 제한시간</h3>
                            <p id="countdown-12h-display" class="text-3xl font-mono text-yellow-400"></p>
                            <button id="start-12h-countdown" class="btn w-48 mt-2 text-md p-2 rounded" data-lang-key="start">시작</button>
                        </div>
                    </div>
                </div>
                
                <!-- Accordion Container (원본 도구) -->
                <div class="space-y-4">
                    <!-- 공대장용 유틸 -->
                    <div class="card accordion-item">
                        <div class="accordion-header flex justify-between items-center cursor-pointer p-4" data-target="#leader-utils">
                            <h2 class="text-2xl font-bold text-yellow-400" data-lang-key="raidLeaderUtils">🛡️ 공대장용 유틸</h2>
                            <i class="fas fa-chevron-down accordion-icon"></i>
                        </div>
                        <div id="leader-utils" class="accordion-content">
                            <div class="p-4 border-t border-gray-700 space-y-8">
                                <!-- 공무 타이머 -->
                                <div>
                                    <h2 class="section-title" data-lang-key="cancelTimerTitle">⚔️ 혼테일 공무 타이머</h2>
                                    <div class="space-y-4 text-center">
                                        <div class="flex justify-center gap-4">
                                            <button id="timer-p1" class="btn timer-btn flex-col h-24 w-48"><span class="font-bold text-lg" data-lang-key="phase1Left">1페이즈 (좌)</span><span class="time-display" data-time="45">45s</span></button>
                                            <button id="timer-p2" class="btn timer-btn flex-col h-24 w-48"><span class="font-bold text-lg" data-lang-key="phase2Right">2페이즈 (우)</span><span class="time-display" data-time="45">45s</span></button>
                                        </div>
                                        <div class="border-t-2 border-dashed border-gray-600 pt-4">
                                            <h3 class="text-center font-bold mb-2 text-yellow-400" data-lang-key="phase3Body">3페이즈 (본체)</h3>
                                            <div class="flex justify-center gap-4">
                                                <button id="timer-left" class="btn timer-btn flex-col h-24 flex-1"><span class="font-bold text-3xl">L</span><span class="font-semibold" data-lang-key="leftHead">좌머리</span><span class="time-display" data-time="45">45s</span></button>
                                                <button id="timer-center" class="btn timer-btn flex-col h-24 flex-1"><span class="font-bold text-3xl">C</span><span class="font-semibold" data-lang-key="middleHead">중앙머리</span><span class="time-display" data-time="45">45s</span></button>
                                                <button id="timer-right" class="btn timer-btn flex-col h-24 flex-1"><span class="font-bold text-3xl">R</span><span class="font-semibold" data-lang-key="rightHead">우머리</span><span class="time-display" data-time="45">45s</span></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 유틸리티 타이머 -->
                                <div>
                                    <h2 class="section-title" data-lang-key="utilityTimers">✨ 유틸리티 타이머</h2>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                                        <!-- 버프 해제 -->
                                        <div class="space-y-4 text-center">
                                            <h3 class="font-bold text-lg" data-lang-key="dispel">버프 해제</h3>
                                            <div class="flex gap-4">
                                                <button id="buff-5m" class="btn timer-btn flex-col h-28 flex-1"><span class="font-bold text-4xl">5</span><span class="font-semibold" data-lang-key="minutes5">5분</span><span class="time-display" data-time="300">5:00</span></button>
                                                <button id="buff-3m" class="btn timer-btn flex-col h-28 flex-1"><span class="font-bold text-4xl">3</span><span class="font-semibold" data-lang-key="minutes3">3분</span><span class="time-display" data-time="180">3:00</span></button>
                                            </div>
                                            <button id="buff-restart" class="btn w-full text-lg" data-lang-key="simultaneousRestart">동시 재시작</button>
                                        </div>
                                        <!-- 만료 시간 -->
                                        <div class="space-y-2 text-center">
                                            <h3 class="font-bold text-lg" data-lang-key="expireTime">만료 시간</h3>
                                            <div class="p-3 bg-black/20 rounded-md h-28 flex flex-col justify-center">
                                                <div class="flex justify-between items-center"><span data-lang-key="buff5min">5분 버프:</span><span id="buff-5m-expire" class="font-bold">--:--:--</span></div>
                                                <div class="flex justify-between items-center mt-2"><span data-lang-key="buff3min">3분 버프:</span><span id="buff-3m-expire" class="font-bold">--:--:--</span></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 유혹조 유틸 -->
                    <div class="card accordion-item">
                        <div class="accordion-header flex justify-between items-center cursor-pointer p-4" data-target="#seduction-team-utils">
                            <h2 class="text-2xl font-bold text-yellow-400" data-lang-key="seduceTeamUtils">🎯 유혹조 유틸</h2>
                            <i class="fas fa-chevron-down accordion-icon"></i>
                        </div>
                        <div id="seduction-team-utils" class="accordion-content">
                            <div class="p-4 border-t border-gray-700">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                        <div class="space-y-4 text-center">
                                        <h3 class="section-title" data-lang-key="skillCooldown">스킬 쿨타임</h3>
                                        <button id="timer-smokescreen" class="btn timer-btn flex-col h-28 w-full"><span class="font-bold text-3xl" data-lang-key="smokescreen">연막</span><span class="time-display" data-time="600">10:00</span></button>
                                        <button id="timer-heroswill" class="btn timer-btn flex-col h-28 w-full mt-4"><span class="font-bold text-3xl" data-lang-key="herosWill">용사의 의지</span><span class="time-display" data-time="600">10:00</span></button>
                                    </div>
                                    <div class="space-y-4">
                                        <h3 class="section-title" data-lang-key="seduceController">실시간 유혹 추적기</h3>
                                        <div class="p-4 bg-black/20 rounded-lg text-center">
                                            <p id="seduction-master-status" class="text-lg font-bold h-7" data-lang-key="statusWaiting">대기 중</p>
                                            <div class="flex items-center justify-center gap-2">
                                                <p id="seduction-master-timer" class="text-5xl font-mono text-red-400 my-2">--:--</p>
                                                <div class="flex flex-col gap-1">
                                                    <button id="seduction-time-up" class="btn time-adjust-btn p-2">▲</button>
                                                    <button id="seduction-time-down" class="btn time-adjust-btn p-2">▼</button>
                                                </div>
                                            </div>
                                            <p id="seduction-master-eta" class="text-md text-gray-400 font-mono h-6 cursor-pointer" title="클릭하여 복사"></p>
                                            <div id="seduction-log" class="seduction-log text-left mt-2"></div>
                                        </div>
                                        <div class="grid grid-cols-2 gap-2">
                                            <button id="seduction-start-btn" class="btn text-lg" data-lang-key="raidStart">레이드 시작</button>
                                            <button id="seduction-confirm-btn" class="btn text-lg" data-lang-key="personalSeduction" disabled>개인유혹</button>
                                        </div>
                                        <button id="seduction-master-reset" class="btn btn-danger w-full text-lg" data-lang-key="resetAll">초기화</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 비숍용 유틸 -->
                    <div class="card accordion-item">
                        <div class="accordion-header flex justify-between items-center cursor-pointer p-4" data-target="#bishop-utils">
                            <h2 class="text-2xl font-bold text-yellow-400" data-lang-key="bishopUtils">💖 비숍용 유틸</h2>
                            <i class="fas fa-chevron-down accordion-icon"></i>
                        </div>
                        <div id="bishop-utils" class="accordion-content">
                            <div class="p-4 border-t border-gray-700">
                                <h2 class="section-title" data-lang-key="resurrectionManagement">리저렉션 관리</h2>
                                <div class="flex items-center justify-center gap-4 mb-6">
                                    <span class="font-semibold" data-lang-key="resurrectionCount">리저렉션 갯수:</span>
                                    <button id="res-minus" class="btn w-10 h-10 text-2xl font-bold">-</button>
                                    <span class="text-2xl font-bold w-10 text-center text-yellow-400" id="res-count">1</span>
                                    <button id="res-plus" class="btn w-10 h-10 text-2xl font-bold">+</button>
                                </div>
                                <div id="res-timers-container" class="space-y-2 max-w-lg mx-auto"></div>
                            </div>
                        </div>
                    </div>
                    <!-- 파티 명단 관리 -->
                    <div class="card accordion-item">
                        <div class="accordion-header flex justify-between items-center cursor-pointer p-4" data-target="#party-manager">
                            <h2 class="text-2xl font-bold" data-lang-key="partyManagement">📋 파티 명단 관리</h2>
                            <i class="fas fa-chevron-down accordion-icon"></i>
                        </div>
                        <div id="party-manager" class="accordion-content">
                            <div class="p-4 border-t border-gray-700">
                                <div class="flex flex-col md:flex-row justify-between items-center mb-4 gap-4">
                                    <div class="flex items-center gap-4">
                                        <div class="flex items-center justify-center gap-2">
                                            <span class="font-semibold" data-lang-key="partyCount">파티 수:</span>
                                            <button id="party-minus-btn" class="btn w-10 h-10 text-xl font-bold">-</button>
                                            <span id="party-count-display" class="text-2xl font-bold w-8 text-center text-yellow-400">4</span>
                                            <button id="party-plus-btn" class="btn w-10 h-10 text-xl font-bold">+</button>
                                        </div>
                                    </div>
                                    <div>
                                        <button id="copy-list-btn" class="btn" data-lang-key="copyPartyList">파티 명단 복사</button>
                                        <span id="copy-feedback" class="font-bold ml-2 opacity-0" data-lang-key="copySuccess">복사 완료!</span>
                                    </div>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                                    <div class="md:col-span-1 flex flex-col">
                                        <h3 class="font-bold text-lg mb-2 text-center" data-lang-key="waitingList">대기 명단</h3>
                                        <textarea id="party-list-input" rows="8" class="input-field mb-2" data-lang-key="pasteListPlaceholder" placeholder="명단 붙여넣기..."></textarea>
                                        <div class="grid grid-cols-2 gap-2">
                                            <button id="generate-list-btn" class="btn w-full" data-lang-key="apply">적용</button>
                                            <button id="reset-list-btn" class="btn btn-danger w-full" data-lang-key="reset">초기화</button>
                                        </div>
                                        <div id="waiting-list" class="party-list mt-2"></div>
                                    </div>
                                    <div id="party-container" class="md:col-span-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 메모장 -->
                    <div class="card accordion-item">
                        <div class="accordion-header flex justify-between items-center cursor-pointer p-4" data-target="#memo-pad-container">
                            <h2 class="text-2xl font-bold" data-lang-key="memoPad">📝 메모장</h2>
                            <i class="fas fa-chevron-down accordion-icon"></i>
                        </div>
                        <div id="memo-pad-container" class="accordion-content">
                            <div class="p-4 border-t border-gray-700">
                                <textarea id="memo-pad" class="input-field w-full h-full min-h-[200px]" data-lang-key="memoPlaceholder" placeholder="여기에 메모를 입력하세요..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 사용자 참여도 강화를 위한 내부 링크 -->
                <div class="mt-16">
                    <h2 class="text-2xl font-bold text-center mb-8 text-yellow-400" data-lang-key="relatedTools">이런 도구는 어떠세요?</h2>
                    <div id="related-tools-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
                </div>

                <!-- [오류 수정] 광고 컨테이너에서 flex 관련 클래스를 제거하여 너비 계산 오류를 해결합니다. -->
                <div class="card mt-12 text-center p-4 min-h-[100px]">
                    <ins class="adsbygoogle"
                         style="display:block"
                         data-ad-client="ca-pub-8602495420447615"
                         data-ad-slot="1274558144"
                         data-ad-format="auto"
                         data-full-width-responsive="true"></ins>
                    <script>
                         (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

            </div>
            
            <!-- [UI 개선] 사이드바를 유튜브 채널 링크로 변경 -->
            <aside id="ad-sidebar" class="lg:sticky top-24 h-fit card p-6 space-y-4 text-center">
                <h3 class="font-bold text-xl" data-lang-key="youtubeChannel">소년아서 채널</h3>
                <i class="fab fa-youtube text-6xl text-red-600"></i>
                <p class="text-gray-400" data-lang-key="youtubeDesc">개발 이야기와 메이플랜드 꿀팁 영상을 만나보세요!</p>
                <!-- [링크 적용] 실제 유튜브 채널 주소로 변경 -->
                <a href="https://www.youtube.com/channel/UCfjb2gmlEhEsBhutIwSr_gQ" target="_blank" rel="noopener noreferrer" class="btn w-full !bg-red-600 !text-white !border-red-700 hover:!bg-red-700">
                    <span data-lang-key="subscribe">구독하고 소식받기</span>
                </a>
            </aside>
        </div>
    </div>
</main>
<!-- ▲▲▲ '혼테일 브레이커' 실제 도구 콘텐츠 끝 ▲▲▲ -->

<footer class="bg-gray-900 border-t border-white/10 mt-16">
    <div class="container mx-auto px-4 py-8 text-center text-slate-400 text-sm">
        <p>&copy; 2025 MLFEE by 소년아서. All Rights Reserved.</p>
    </div>
</footer>

<!-- ▼▼▼ '혼테일 브레이커' 원본 JavaScript 로직 시작 ▼▼▼ -->
<script>
document.addEventListener('DOMContentLoaded', () => {
    const CONSTANTS = { HORNTAIL_DURATION: 12 * 60 * 60 * 1000, SEDUCTION_FIRST_DELAY: 2 * 60 * 1000, SEDUCTION_PREDICTION_INTERVAL: 3 * 60 * 1000, DEATH_TIMER_DURATION: 15 * 60 * 1000, RESURRECTION_COOLDOWN: 30 * 60 * 1000, MAX_PARTIES: 8, MIN_PARTIES: 1, };
    const translations = { 
        ko: { mainTitle: '혼테일 브레이커', creator: 'by 소년아서', currentTime: '현재 시간', horntailLimit: '혼테일 제한시간', start: '시작', raidLeaderUtils: '🛡️ 공대장용 유틸', cancelTimerTitle: '⚔️ 혼테일 공무 타이머', phase1Left: '1페이즈 (좌)', phase2Right: '2페이즈 (우)', phase3Body: '3페이즈 (본체)', leftHead: '좌머리', middleHead: '중앙머리', rightHead: '우머리', utilityTimers: '✨ 유틸리티 타이머', dispel: '버프 해제', minutes5: '5분', minutes3: '3분', simultaneousRestart: '동시 재시작', expireTime: '만료 시간', buff5min: '5분 버프:', buff3min: '3분 버프:', seduceTeamUtils: '🎯 유혹조 유틸', skillCooldown: '스킬 쿨타임', smokescreen: '연막', herosWill: '용사의 의지', seduceController: '실시간 유혹 추적기', statusWaiting: '대기 중', raidStart: '레이드 시작', resetAll: '초기화', bishopUtils: '💖 비숍용 유틸', resurrectionManagement: '리저렉션 관리', resurrectionCount: '리저렉션 갯수:', partyManagement: '📋 파티 명단 관리', partyCount: '파티 수:', copyPartyList: '파티 명단 복사', copySuccess: '복사 완료!', waitingList: '대기 명단', pasteListPlaceholder: '명단 붙여넣기...', apply: '적용', reset: '초기화', memoPad: '📝 메모장', memoPlaceholder: '여기에 메모를 입력하세요...', use: '사용', bishopNicknamePlaceholder: '비숍 {i} 닉네임', partyTitle: '{i}파티', deathButton: '다이', statusFirstSeduce: '첫 유혹 카운트다운', statusTracking: '경과 시간 (스톱워치)', etaPrefix: '예상:', timeFormat: '{h}시간 {m}분 {s}초', personalSeduction: '개인유혹', relatedTools: '이런 도구는 어떠세요?', tool_calc: 'N빵마스터', tool_calc_tagline: '수수료 걱정 없는 완벽한 분배', tool_timer: '리저 타이머', tool_timer_tagline: '부활과 버프, 놓치지 마세요', tool_ledger: '혼테일렛저', tool_ledger_tagline: '보상과 기여도 자동 기록', tool_breaker: '혼테일 브레이커', tool_breaker_tagline: '최적의 공략 순서 시뮬레이터', tool_buff: '메피 버피', tool_buff_tagline: '최적의 버프 순서와 타이밍', tool_janus: '프로젝트 야누스', tool_janus_desc: '새로운 세계관과 인지 테스트', sponsor: '스폰서', youtubeChannel: '소년아서 채널', youtubeDesc: '개발 이야기와 꿀팁을 만나보세요!', subscribe: '구독하고 소식받기' }, 
        en: { mainTitle: 'Horntail Breaker', creator: 'by sonyeon-aseo', currentTime: 'Current Time', horntailLimit: 'Horntail Time Limit', start: 'Start', raidLeaderUtils: '🛡️ Raid Leader Utils', cancelTimerTitle: '⚔️ Horntail Skill Cancel Timer', phase1Left: 'Phase 1 (Left)', phase2Right: 'Phase 2 (Right)', phase3Body: 'Phase 3 (Main Body)', leftHead: 'Left Head', middleHead: 'Middle Head', rightHead: 'Right Head', utilityTimers: '✨ Utility Timers', dispel: 'Dispel', minutes5: '5 Minutes', minutes3: '3 Minutes', simultaneousRestart: 'Simultaneous Restart', expireTime: 'Expiration Time', buff5min: '5min Buff:', buff3min: '3min Buff:', seduceTeamUtils: '🎯 Seduce Team Utils', skillCooldown: 'Skill Cooldown', smokescreen: 'Smokescreen', herosWill: "Hero's Will", seduceController: 'Real-time Seduction Tracker', statusWaiting: 'Waiting', raidStart: 'Raid Start', resetAll: 'Reset', bishopUtils: '💖 Bishop Utils', resurrectionManagement: 'Resurrection Management', resurrectionCount: 'Resurrection Count:', partyManagement: '📋 Party Management', partyCount: 'Party Count:', copyPartyList: 'Copy Party List', copySuccess: 'Copied!', waitingList: 'Waiting List', pasteListPlaceholder: 'Paste list here...', apply: 'Apply', reset: 'Reset', memoPad: '📝 Memo Pad', memoPlaceholder: 'Enter your memo here...', use: 'Use', bishopNicknamePlaceholder: 'Bishop {i} Nickname', partyTitle: 'Party {i}', deathButton: 'Death', statusFirstSeduce: 'First Seduction Countdown', statusTracking: 'Elapsed Time (Stopwatch)', etaPrefix: 'ETA:', timeFormat: '{h}h {m}m {s}s', personalSeduction: 'Personal Seduction', relatedTools: 'How about these tools?', tool_calc: 'Split Master', tool_calc_tagline: 'Perfect distribution without fee worries', tool_timer: 'Resurrection Timer', tool_timer_tagline: 'Don\'t miss resurrections and buffs', tool_ledger: 'Horntail Ledger', tool_ledger_tagline: 'Auto-record rewards & contributions', tool_breaker: 'Horntail Breaker', tool_breaker_tagline: 'Optimal attack sequence simulator', tool_buff: 'Mefi Buffy', tool_buff_tagline: 'Optimal buff order & timing', tool_janus: 'Project Janus', tool_janus_desc: 'A new universe and cognitive tests', sponsor: 'Sponsor', youtubeChannel: 'Boy Arthur Channel', youtubeDesc: 'Check out dev stories and pro tips!', subscribe: 'Subscribe for Updates' }, 
        ja: { mainTitle: 'ホーンテイルブレイカー', creator: 'by 소년아서', currentTime: '現在時刻', horntailLimit: 'ホーンテイル制限時間', start: '開始', raidLeaderUtils: '🛡️ 遠征隊長ユーティリティ', cancelTimerTitle: '⚔️ ホーンテイル スキル無効化タイマー', phase1Left: '1段階 (左)', phase2Right: '2段階 (右)', phase3Body: '3段階 (本体)', leftHead: '左頭', middleHead: '中央頭', rightHead: '右頭', utilityTimers: '✨ ユーティリティタイマー', dispel: 'ディスペル', minutes5: '5分', minutes3: '3分', simultaneousRestart: '同時再起動', expireTime: '満了時間', buff5min: '5分バフ:', buff3min: '3分バフ:', seduceTeamUtils: '🎯 誘惑組ユーティリティ', skillCooldown: 'スキルクールタイム', smokescreen: '煙幕', herosWill: 'ヒーローズウィル', seduceController: 'リアルタイム誘惑トラッカー', statusWaiting: '待機中', raidStart: 'レイド開始', resetAll: 'リセット', bishopUtils: '💖 ビショップユーティリティ', resurrectionManagement: 'リザレクション管理', resurrectionCount: 'リザレクション数:', partyManagement: '📋 パーティーリスト管理', partyCount: 'パーティー数:', copyPartyList: 'パーティーリストコピー', copySuccess: 'コピー完了!', waitingList: '待機リスト', pasteListPlaceholder: 'リストを貼り付け...', apply: '適用', reset: 'リセット', memoPad: '📝 メモ帳', memoPlaceholder: 'ここにメモを入力...', use: '使用', bishopNicknamePlaceholder: 'ビショップ {i} ニックネーム', partyTitle: '{i}パーティー', deathButton: '死亡', statusFirstSeduce: '最初の誘惑カウントダウン', statusTracking: '経過時間 (ストップウォッチ)', etaPrefix: '予想:', timeFormat: '{h}時間{m}分{s}秒', personalSeduction: '個人誘惑', relatedTools: 'こちらのツールはいかがですか？', tool_calc: '割り勘マスター', tool_calc_tagline: '手数料の心配ない完璧な分配', tool_timer: 'リザレクションタイマー', tool_timer_tagline: '復活とバフ、お見逃しなく', tool_ledger: 'ホーンテイル元帳', tool_ledger_tagline: '報酬と貢献度を自動記録', tool_breaker: 'ホーンテイルブレーカー', tool_breaker_tagline: '最適攻略順序シミュレーター', tool_buff: 'メピバフィ', tool_buff_tagline: '最適なバフ順序とタイミング', tool_janus: 'プロジェクト・ヤヌス', tool_janus_desc: '新しい世界観と認知テスト', sponsor: 'スポンサー', youtubeChannel: 'ソニョンアーサーチャンネル', youtubeDesc: '開発ストーリーや役立つヒントをチェック！', subscribe: 'チャンネル登録' } 
    };
    const langLocaleMap = { ko: 'ko-KR', en: 'en-US', ja: 'ja-JP' };
    const state = { timers: {}, resurrection: { states: {}, count: 1 }, party: { count: 4 }, deathTimers: {}, seductionMaster: { interval: null, startTime: null, lastSeduceTime: null, count: 0, mode: 'idle' }, countdown12hInterval: null, currentLanguage: 'ko' };
    const ui = { browserClock: document.getElementById('browser-clock'), countdownDisplay: document.getElementById('countdown-12h-display'), start12hBtn: document.getElementById('start-12h-countdown'), resCountEl: document.getElementById('res-count'), resContainer: document.getElementById('res-timers-container'), seductionStatus: document.getElementById('seduction-master-status'), seductionTimer: document.getElementById('seduction-master-timer'), seductionEta: document.getElementById('seduction-master-eta'), seductionLog: document.getElementById('seduction-log'), seductionStartBtn: document.getElementById('seduction-start-btn'), seductionConfirmBtn: document.getElementById('seduction-confirm-btn'), masterResetBtn: document.getElementById('seduction-master-reset'), seductionTimeUp: document.getElementById('seduction-time-up'), seductionTimeDown: document.getElementById('seduction-time-down'), partyCountDisplay: document.getElementById('party-count-display'), waitingList: document.getElementById('waiting-list'), partyContainer: document.getElementById('party-container'), partyListInput: document.getElementById('party-list-input'), copyFeedback: document.getElementById('copy-feedback'), memoPad: document.getElementById('memo-pad'), };
    
    // --- [FIX 1] 아코디언 높이 자동 조절 함수 ---
    // 내용 변경 시 열려있는 아코디언의 높이를 다시 계산하여 UI가 깨지지 않도록 합니다.
    function updateOpenAccordions() {
        document.querySelectorAll('.accordion-header.active').forEach(header => {
            const content = header.nextElementSibling;
            if (content && content.classList.contains('accordion-content')) {
                content.style.maxHeight = content.scrollHeight + "px";
            }
        });
    }

    // --- SMART TOOL RECOMMENDATION ---
    const allTools = [
        { id: 'calc', url: '../calc/' },
        { id: 'breaker', url: './' },
        { id: 'timer', url: '../timer/' },
        { id: 'ledger', url: '../ledger/' },
        { id: 'buff', url: '../buff/' },
        { id: 'janus', url: '../janus/roadmap.html' }
    ];

    function generateRecommendedTools() {
        const container = document.getElementById('related-tools-container');
        const currentToolId = document.body.dataset.toolId;
        if (!container || !currentToolId) return;

        const otherTools = allTools.filter(tool => tool.id !== currentToolId);
        const shuffled = otherTools.sort(() => 0.5 - Math.random());
        const recommendations = shuffled.slice(0, 3);
        
        const lang = LanguageManager.get();
        let htmlContent = '';
        recommendations.forEach(tool => {
            const nameKey = `tool_${tool.id}`;
            const taglineKey = tool.id === 'janus' ? 'tool_janus_desc' : `tool_${tool.id}_tagline`;

            const name = translations[lang][nameKey] || tool.id;
            const tagline = translations[lang][taglineKey] || '';

            htmlContent += `
                <a href="${tool.url}" class="card p-6 hover:border-yellow-400 transition-colors">
                    <h3 class="font-bold text-xl">${name}</h3>
                    <p class="text-gray-400 text-sm mt-1">${tagline}</p>
                </a>
            `;
        });
        container.innerHTML = htmlContent;
    }

    const LanguageManager = { 
        set(lang) { 
            state.currentLanguage = lang; 
            document.documentElement.lang = lang; 
            document.querySelectorAll('[data-lang-key]').forEach(el => { 
                const key = el.dataset.langKey; 
                const translation = translations[lang][key] || translations['ko'][key];
                if (translation) { 
                    if (el.placeholder !== undefined) el.placeholder = translation; 
                    else el.innerHTML = translation;
                } 
            }); 
            ResurrectionManager.updateUI(); 
            PartyManager.updateUI(); 
            document.querySelectorAll('.lang-btn').forEach(btn => { 
                btn.classList.toggle('selected', btn.dataset.lang === lang); 
            }); 
            localStorage.setItem('language', lang);
            generateRecommendedTools();
        }, 
        get() { return state.currentLanguage; }, 
        init() { const savedLang = localStorage.getItem('language') || 'ko'; this.set(savedLang); document.getElementById('language-selector').addEventListener('click', (e) => { if (e.target.dataset.lang) this.set(e.target.dataset.lang); }); } 
    };
    const TimerManager = { formatTime(totalSeconds) { if (totalSeconds >= 60) { const minutes = Math.floor(totalSeconds / 60); const seconds = totalSeconds % 60; return `${minutes}:${String(seconds).padStart(2, '0')}`; } return LanguageManager.get() === 'ko' ? `${totalSeconds}초` : `${totalSeconds}s`; }, start(id, duration, displayEl, buttonEl, onEnd) { if (state.timers[id]?.interval) clearInterval(state.timers[id].interval); const endTime = Date.now() + duration * 1000; let lastDisplayValue = ''; state.timers[id] = { interval: setInterval(() => { const diff = endTime - Date.now(); if (diff <= 0) { this.stop(id, duration, displayEl, buttonEl, onEnd); return; } const newDisplayValue = this.formatTime(Math.ceil(diff / 1000)); if (newDisplayValue !== lastDisplayValue) { displayEl.textContent = newDisplayValue; lastDisplayValue = newDisplayValue; } }, 100) }; }, stop(id, duration, displayEl, buttonEl, onEnd) { if (state.timers[id]?.interval) { clearInterval(state.timers[id].interval); delete state.timers[id]; } displayEl.textContent = this.formatTime(duration); if (buttonEl) buttonEl.classList.remove('active'); if (onEnd) onEnd(); } };
    const SeductionController = { runTimer() { const now = Date.now(); let diff, displayTime; if (state.seductionMaster.mode === 'initial_countdown') { diff = (state.seductionMaster.startTime + CONSTANTS.SEDUCTION_FIRST_DELAY) - now; displayTime = this.formatMS(diff); if (diff <= 0) { this.transitionToMode('tracking'); } } else if (state.seductionMaster.mode === 'tracking') { diff = now - state.seductionMaster.startTime; displayTime = this.formatMS(diff); } else { displayTime = '--:--'; } ui.seductionTimer.textContent = displayTime; }, transitionToMode(newMode) { const lang = LanguageManager.get(); state.seductionMaster.mode = newMode; state.seductionMaster.startTime = Date.now(); if (newMode === 'initial_countdown') { ui.seductionStatus.textContent = translations[lang].statusFirstSeduce; ui.seductionConfirmBtn.disabled = false; } else if (newMode === 'tracking') { ui.seductionStatus.textContent = translations[lang].statusTracking; } }, confirmSeduction() { const now = Date.now(); state.seductionMaster.count++; let intervalText = ''; if (state.seductionMaster.lastSeduceTime) { const interval = (now - state.seductionMaster.lastSeduceTime) / 1000; const min = Math.floor(interval / 60); const sec = Math.round(interval % 60); intervalText = ` (+${min}m ${sec}s)`; } const logEntry = document.createElement('div'); logEntry.textContent = `[${state.seductionMaster.count}] ${new Date(now).toLocaleTimeString('ko-KR')} ${intervalText}`; ui.seductionLog.appendChild(logEntry); ui.seductionLog.scrollTop = ui.seductionLog.scrollHeight; state.seductionMaster.lastSeduceTime = now; this.updateETA(now + CONSTANTS.SEDUCTION_PREDICTION_INTERVAL); this.transitionToMode('tracking'); }, updateETA(time) { const lang = LanguageManager.get(); if (!time) { ui.seductionEta.textContent = ''; return; } const eta = new Date(time); ui.seductionEta.textContent = `${translations[lang].etaPrefix} ${eta.toLocaleTimeString('ko-KR', { hour12: false, hour: '2-digit', minute: '2-digit' })}`; }, start() { this.reset(); this.transitionToMode('initial_countdown'); if (!state.seductionMaster.interval) { state.seductionMaster.interval = setInterval(() => this.runTimer(), 100); } }, reset() { const lang = LanguageManager.get(); if (state.seductionMaster.interval) clearInterval(state.seductionMaster.interval); Object.assign(state.seductionMaster, { interval: null, startTime: null, lastSeduceTime: null, count: 0, mode: 'idle' }); ui.seductionStatus.textContent = translations[lang].statusWaiting; ui.seductionTimer.textContent = '--:--'; ui.seductionEta.textContent = ''; ui.seductionLog.innerHTML = ''; ui.seductionConfirmBtn.disabled = true; }, adjustTime(seconds) { if (state.seductionMaster.mode === 'idle') return; const adjustment = seconds * 1000; if (state.seductionMaster.mode === 'initial_countdown') { state.seductionMaster.startTime += adjustment; } else if (state.seductionMaster.mode === 'tracking') { state.seductionMaster.startTime -= adjustment; } this.runTimer(); }, formatMS(ms) { if (ms < 0) ms = 0; const totalSeconds = Math.floor(ms / 1000); const minutes = Math.floor(totalSeconds / 60); const seconds = totalSeconds % 60; return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`; }, init() { ui.seductionStartBtn.addEventListener('click', () => this.start()); ui.seductionConfirmBtn.addEventListener('click', () => this.confirmSeduction()); ui.masterResetBtn.addEventListener('click', () => this.reset()); ui.seductionTimeUp.addEventListener('click', () => this.adjustTime(1)); ui.seductionTimeDown.addEventListener('click', () => this.adjustTime(-1)); ui.seductionEta.addEventListener('click', () => { const etaText = ui.seductionEta.textContent; const timeMatch = etaText.match(/\d{2}:\d{2}/); if (timeMatch) { navigator.clipboard.writeText(timeMatch[0]).catch(err => console.error('Copy failed', err)); } }); } };
    const ResurrectionManager = { updateUI() { const lang = LanguageManager.get(); ui.resContainer.innerHTML = ''; for (let i = 1; i <= state.resurrection.count; i++) { const resId = `res-${i}`; if (!state.resurrection.states[resId]) { state.resurrection.states[resId] = { nickname: '', endTime: null, interval: null }; } const resState = state.resurrection.states[resId]; const wrapper = document.createElement('div'); wrapper.className = 'flex items-center gap-2'; const nicknameInput = document.createElement('input'); nicknameInput.type = 'text'; nicknameInput.placeholder = translations[lang].bishopNicknamePlaceholder.replace('{i}', i); nicknameInput.className = 'input-field w-full'; nicknameInput.value = resState.nickname || ''; nicknameInput.addEventListener('input', (e) => { resState.nickname = e.target.value; this.saveState(); }); const button = document.createElement('button'); button.id = resId; button.className = 'btn text-lg w-32 flex-shrink-0'; const expireEl = document.createElement('span'); expireEl.id = `${resId}-expire`; expireEl.className = 'font-bold text-center w-28 flex-shrink-0'; wrapper.append(nicknameInput, button, expireEl); ui.resContainer.appendChild(wrapper); button.addEventListener('click', () => this.handleClick(resId, button, expireEl, nicknameInput)); if (resState.endTime && resState.endTime > Date.now()) { this.handleClick(resId, button, expireEl, nicknameInput, true); } else { resState.endTime = null; button.textContent = translations[lang].use; expireEl.textContent = '--:--:--'; } } this.saveState(); }, handleClick(resId, button, expireEl, nicknameInput, isRestart = false) { const lang = LanguageManager.get(); if (button.disabled && !isRestart) return; const resState = state.resurrection.states[resId]; if (resState.interval) clearInterval(resState.interval); button.disabled = true; nicknameInput.disabled = true; if (!isRestart) { resState.endTime = Date.now() + CONSTANTS.RESURRECTION_COOLDOWN; this.saveState(); } expireEl.textContent = new Date(resState.endTime).toLocaleTimeString('ko-KR', { hour12: false }); resState.interval = setInterval(() => { const diff = resState.endTime - Date.now(); if (diff <= 0) { clearInterval(resState.interval); button.textContent = translations[lang].use; button.disabled = false; nicknameInput.disabled = false; expireEl.textContent = '--:--:--'; resState.endTime = null; resState.interval = null; this.saveState(); return; } const remainingMinutes = Math.floor(diff / 1000 / 60); const remainingSeconds = Math.floor(diff / 1000) % 60; button.textContent = `${String(remainingMinutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`; }, 1000); }, changeCount(amount) { const newCount = state.resurrection.count + amount; if (newCount >= 1 && newCount <= 10) { if (amount < 0) { const resIdToRemove = `res-${state.resurrection.count}`; if (state.resurrection.states[resIdToRemove]?.interval) { clearInterval(state.resurrection.states[resIdToRemove].interval); } delete state.resurrection.states[resIdToRemove]; } state.resurrection.count = newCount; ui.resCountEl.textContent = newCount; this.updateUI(); 
    // [FIX 1-1] 리저렉션 갯수 변경 시 아코디언 높이 재조정
    updateOpenAccordions();
    } }, saveState() { const stateToSave = JSON.parse(JSON.stringify(state.resurrection.states)); Object.keys(stateToSave).forEach(key => delete stateToSave[key].interval); localStorage.setItem('resurrectionStates', JSON.stringify(stateToSave)); localStorage.setItem('resurrectionCount', state.resurrection.count); }, loadState() { const savedStates = localStorage.getItem('resurrectionStates'); if (savedStates) state.resurrection.states = JSON.parse(savedStates); const savedCount = localStorage.getItem('resurrectionCount'); state.resurrection.count = savedCount ? parseInt(savedCount, 10) : 1; ui.resCountEl.textContent = state.resurrection.count; }, init() { this.loadState(); this.updateUI(); document.getElementById('res-minus').addEventListener('click', () => this.changeCount(-1)); document.getElementById('res-plus').addEventListener('click', () => this.changeCount(1)); } };
    const PartyManager = { updateUI() { const lang = LanguageManager.get(); const memberStates = new Map(); document.querySelectorAll('.draggable-item').forEach(item => { memberStates.set(item.dataset.id, { name: item.querySelector('span:first-child').textContent, listId: item.parentElement.id }); }); if (document.querySelectorAll('#party-container > div').length > state.party.count) { const lastPartyId = `party-${document.querySelectorAll('#party-container > div').length}`; document.querySelectorAll(`#${lastPartyId} .draggable-item`).forEach(item => { memberStates.get(item.dataset.id).listId = 'waiting-list'; }); } ui.partyContainer.innerHTML = ''; for (let i = 1; i <= state.party.count; i++) { const partyWrapper = document.createElement('div'); partyWrapper.className = 'flex flex-col'; const partyTitle = document.createElement('h3'); partyTitle.className = 'font-bold text-lg mb-2 text-center'; partyTitle.textContent = translations[lang].partyTitle.replace('{i}', i); const partyList = document.createElement('div'); partyList.className = 'party-list'; partyList.id = `party-${i}`; partyWrapper.append(partyTitle, partyList); ui.partyContainer.appendChild(partyWrapper); new Sortable(partyList, { group: 'party', animation: 150, ghostClass: 'sortable-ghost' }); } const partyGrid = ui.partyContainer.children.length; ui.partyContainer.style.gridTemplateColumns = `repeat(${Math.min(partyGrid, 4)}, 1fr)`; ui.waitingList.innerHTML = ''; memberStates.forEach((memberState, id) => { const targetList = document.getElementById(memberState.listId) || ui.waitingList; targetList.appendChild(this.createDraggableItem(memberState.name, id)); }); ui.partyCountDisplay.textContent = state.party.count; 
    // [FIX 1-2] 파티 UI 변경 시 아코디언 높이 재조정
    updateOpenAccordions();
    }, createDraggableItem(name, id) { const lang = LanguageManager.get(); const item = document.createElement('div'); item.className = 'draggable-item'; item.dataset.id = id; const nameSpan = document.createElement('span'); nameSpan.textContent = name.trim(); const controlsDiv = document.createElement('div'); controlsDiv.className = 'flex items-center'; const timerDisplay = document.createElement('span'); timerDisplay.className = 'death-timer-display'; const deathBtn = document.createElement('button'); deathBtn.className = 'btn btn-death p-2'; deathBtn.textContent = translations[lang].deathButton; controlsDiv.append(timerDisplay, deathBtn); item.append(nameSpan, controlsDiv); return item; }, init() { this.updateUI(); 
    // [FIX 2] 대기 명단(waiting-list)도 드래그 앤 드롭이 가능하도록 Sortable 초기화
    new Sortable(ui.waitingList, { group: 'party', animation: 150, ghostClass: 'sortable-ghost' });
    document.getElementById('party-plus-btn').addEventListener('click', () => { if (state.party.count < CONSTANTS.MAX_PARTIES) { state.party.count++; this.updateUI(); } }); document.getElementById('party-minus-btn').addEventListener('click', () => { if (state.party.count > CONSTANTS.MIN_PARTIES) { state.party.count--; this.updateUI(); } }); document.getElementById('generate-list-btn').addEventListener('click', () => { const names = ui.partyListInput.value.split('\n').filter(name => name.trim() !== ''); names.forEach(name => { const uniqueId = `member-${Date.now()}-${Math.random()}`; ui.waitingList.appendChild(this.createDraggableItem(name, uniqueId)); }); ui.partyListInput.value = ''; 
    // [FIX 1-3] 명단 적용 시 아코디언 높이 재조정
    updateOpenAccordions();
    }); document.getElementById('reset-list-btn').addEventListener('click', () => { ui.waitingList.innerHTML = ''; document.querySelectorAll('#party-container .party-list').forEach(list => { list.innerHTML = ''; }); Object.values(state.deathTimers).forEach(timer => clearInterval(timer.interval)); state.deathTimers = {}; 
    // [FIX 1-4] 명단 초기화 시 아코디언 높이 재조정
    updateOpenAccordions();
    }); document.getElementById('copy-list-btn').addEventListener('click', () => { const lang = LanguageManager.get(); let fullPartyList = ''; document.querySelectorAll('#party-container > div').forEach((listWrapper, index) => { const list = listWrapper.querySelector('.party-list'); const members = Array.from(list.children).map(item => `- ${item.querySelector("span:first-child").textContent}`); if (members.length > 0) { fullPartyList += `[${translations[lang].partyTitle.replace('{i}', index + 1)}]\n${members.join('\n')}\n\n`; } }); const waitingMembers = Array.from(ui.waitingList.children).map(item => `- ${item.querySelector("span:first-child").textContent}`); if (waitingMembers.length > 0) { fullPartyList += `[${translations[lang].waitingList}]\n${waitingMembers.join('\n')}\n`; } if (!fullPartyList.trim()) return; navigator.clipboard.writeText(fullPartyList.trim()).then(() => { ui.copyFeedback.style.opacity = '1'; setTimeout(() => { ui.copyFeedback.style.opacity = '0'; }, 2000); }).catch(err => { console.error('Failed to copy party list: ', err); }); }); document.querySelector('.w-full.max-w-screen-2xl').addEventListener('click', (e) => { if (e.target.classList.contains('btn-death')) { const item = e.target.closest('.draggable-item'); const memberId = item.dataset.id; const display = item.querySelector('.death-timer-display'); if (state.deathTimers[memberId]) return; e.target.disabled = true; const endTime = Date.now() + CONSTANTS.DEATH_TIMER_DURATION; state.deathTimers[memberId] = { interval: setInterval(() => { const diff = endTime - Date.now(); if (diff <= 0) { clearInterval(state.deathTimers[memberId].interval); delete state.deathTimers[memberId]; display.textContent = ''; e.target.disabled = false; return; } const minutes = Math.floor((diff / 1000 / 60) % 60); const seconds = Math.floor((diff / 1000) % 60); display.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`; }, 1000) }; } }); } };
    function initializeApp() { const updateCountdownDisplay = (h, m, s) => { const lang = LanguageManager.get(); let format = translations[lang].timeFormat; if (!format) format = translations['ko'].timeFormat; const timeString = format .replace('{h}', h) .replace('{m}', String(m).padStart(2, '0')) .replace('{s}', String(s).padStart(2, '0')); ui.countdownDisplay.textContent = timeString; }; setInterval(() => { const lang = LanguageManager.get(); const locale = langLocaleMap[lang] || 'ko-KR'; ui.browserClock.textContent = new Date().toLocaleTimeString(locale, { hour12: false }); }, 1000); LanguageManager.init(); ResurrectionManager.init(); PartyManager.init(); SeductionController.init(); updateCountdownDisplay(12, 0, 0); ui.start12hBtn.addEventListener('click', () => { if (state.countdown12hInterval) clearInterval(state.countdown12hInterval); const endTime = Date.now() + CONSTANTS.HORNTAIL_DURATION; state.countdown12hInterval = setInterval(() => { const diff = endTime - Date.now(); if (diff <= 0) { clearInterval(state.countdown12hInterval); updateCountdownDisplay(0, 0, 0); return; } const hours = Math.floor(diff / (1000 * 60 * 60)); const minutes = Math.floor((diff / 1000 / 60) % 60); const seconds = Math.floor((diff / 1000) % 60); updateCountdownDisplay(hours, minutes, seconds); }, 1000); }); document.querySelectorAll('.timer-btn').forEach(button => { const id = button.id; const timerDisplay = button.querySelector('.time-display'); const initialSeconds = parseInt(timerDisplay.dataset.time, 10); if (isNaN(initialSeconds)) { console.error(`Invalid time data for button #${id}`); return; } button.addEventListener('click', () => { button.classList.add('active'); TimerManager.start(id, initialSeconds, timerDisplay, button, () => { if (id.includes('buff')) document.getElementById(`${id}-expire`).textContent = '--:--:--'; }); if (id.includes('buff')) document.getElementById(`${id}-expire`).textContent = new Date(Date.now() + initialSeconds * 1000).toLocaleTimeString('ko-KR', { hour12: false }); }); }); document.getElementById('buff-restart').addEventListener('click', () => { document.getElementById('buff-5m').click(); document.getElementById('buff-3m').click(); }); ui.memoPad.value = localStorage.getItem('memoContent') || ''; ui.memoPad.addEventListener('input', () => localStorage.setItem('memoContent', ui.memoPad.value)); const accordionItems = document.querySelectorAll('.accordion-item'); const accordionStates = JSON.parse(localStorage.getItem('accordionStates')) || {}; accordionItems.forEach(item => { const header = item.querySelector('.accordion-header'); const content = item.querySelector('.accordion-content'); const targetId = header.dataset.target.substring(1); if (accordionStates[targetId] === 'open') { header.classList.add('active'); content.style.maxHeight = content.scrollHeight + "px"; } header.addEventListener('click', () => { header.classList.toggle('active'); const isOpen = header.classList.contains('active'); content.style.maxHeight = isOpen ? content.scrollHeight + "px" : null; accordionStates[targetId] = isOpen ? 'open' : 'closed'; localStorage.setItem('accordionStates', JSON.stringify(accordionStates)); }); }); }
    initializeApp();
});
</script>
<!-- ▲▲▲ '혼테일 브레이커' 원본 JavaScript 로직 끝 ▲▲▲ -->

</body>
</html>
